---
order: 10
title: Публикация в подключение
---

*Начало*: я создал новый локальный каталог и пока не синхронизировал его (см. один из предыдущих сценариев).

1. **Список подключений**: В гитовой панели я нажимаю иконку перечеркнутого облака  [icon:cloud-slash]. Вываливается список из моих подключений и кнопки «Добавить».

2. **Автоподключение из приглашению**: В списке подключений я вижу пункты [gitlab.ics-it.ru](http://gitlab.ics-it.ru) и Яндекс.Диск.  Эти пункты появились, т.к. я ранее принял приглашение на DocReader из почты и у меня из этого приглашения автоматически добавились корпоративные настройки.

3. **Добавление нового подключения**: Этот каталог я хочу опубликовать на свой личный эккаунт GitHub, поэтому я нажимаю «Добавить подключение», появляется поле «Тип подключения» с выпадающим списком всех поддерживаемых типов подключений из 2 секций: “файловые” (Google.Диск, Яндекс.Диск и тп.) и “системы контроля версий” (GitHub, GitLab). Выбираю нужный мне тип GitHub.

4. **Настройка подключения**: Открывается окно ввода настроек подключения. Для системы контроля версий это URL-сервера и параметры аутентификации (для файлового были бы параметры аутентификации и рабочий каталог). Заполняю параметры и подтверждаю нажатием “Добавить подключение”.

5. **Настройки публикации в подключение**: Открывается окно публикации в котором выводится краткая информация по созданному подключению GitHub, а также настройки публикации: поле «Slug», предзаполненное названием моего локального каталога.

   *Если бы выбрал файловое подключение, то бы вывелось поле «Поддиректория», и также предзаполнялось.*

6. **Публикация**: После подтверждения начинается публикация локального репозитория в подключение, крутилка у облака крутится. После завершения синхронизации крутилка пропадает.

7. **Статус публикации**: В гитовой панели с зачеркнутого облака пропало зачеркивание и теперь по иконке видно, что локальный репозиторий подключен к облаку. При наведении на облако в тултипе показывается название подключения.

8. **Автоматическая синхронизация**: После публикации осуществляется автоматическая синхронизация локального репозитория с удаленным. Так же как в vscode, показывается кол-во изменений впереди текущей ревизии независимо от того, файловое это подключение или git.

### Комментарии

-  В приглашении на DocReader есть вариант помимо передачи по ссылке в приглашения сделать сервер с корпоративными настройками, в котором хранятся настройки корпоративного окружения. Тогда в приглашении будет подключение к этому серверу конфигурации корпоративной среды DocReader

#### Синхронизация с облачным диском

-  На облачные диски, например Google Drive, есть простой API для синхронизации, который мы можем встроить в приложение. Важно уметь это делать отдельными модулями.

-  Поизучал как на низком уровне устроена папочка `.git/` в git-репозитории: на каждый новый бренч, тег и коммит создается новый файл. Поэтому при синхронизации достаточно проверять наличие новых файлов. Поэтому синхронизация с диском должна быть достаточно простая и быстрая.

-  На облачном диске будем хранить только содержимое папки `.git/` без некоторых файлов:

   -  `.git/HEAD` и `.git/index` -- хранит текущую ревизию каталога

   -  `.git/config` -- хранит настройки текущего пользователя.

-  Git поддерживает синхронизацию как с git-серверами, так и с обычными локальными директориями. Это может потребоваться, если без проблем не заработает синхронизация гитовой директории напрямую.

-  При указании директории, важно не располагать репозитории под другими репозиториями. При публикации делать проверку на это.

#### Типы подключений

**Системы контроля версий**:

-  Виды: GitLab, GitHub

-  Настройки

   -  URL - для gitlab,

   -  org-name - для github

   -  Аутентификация: SSO или логин+пароль или токен

-  Отображаемое название: `<тип>: [URL сервера] <org-name|username>`, например “GitHub: ics-it” или “GitLab: [gitlab.ics-it.ru](http://gitlab.ics-it.ru)”

-  Настройки каталога: slug

**Облачные файловые хранилища**:

-  Виды: Яндекс.Диск, Google Disk, Dropbox, OneDrive

-  Настройки:

   -  Аутентификация: SSO или логин+пароль

   -  Рабочая директория - корневая директория для каталогов

-  Отображаемое название подключения: `<тип>: <имя SSO|логин> <директория>`, “Яндекс.Диск: [ics-it.ru](http://ics-it.ru) /Документация”.

-  Настройки каталога: Поддиректория (по умолчанию совпадает со slug каталога)