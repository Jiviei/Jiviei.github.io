---
order: 12
title: "@KV @AL [done] Экспорт со стилями DOCX"
---

Сейчас мы можем выгружать в DOCX  элементы, но без стилей. Нужно выгружать из них контент так, чтобы он был похож на исходную статью, но в стилях DOCX.

[zagolovok-2-zagolovok-3-zagolovok-4.docx](./zagolovok-2-zagolovok-3-zagolovok-4.docx)

## Критерии

-  Любой текст, экспортируемой статьи, стилизован с помощью стилей, которые находятся в галерее стилей.

![](./docx-style_1.png "Все стили, которые вы можете настроить можно увидеть при экспорте любой статьи")

-  Стилизация блоков `заметка`, `цитата`, `блок кода,` `блоки скрытого текста`, `вкладки` выполнены через стили из дизайн-таблицы:

![](./docx-style-38.png "Стили таблиц")

-  Для нумерованных и маркированных списков не применяются никакие общие стили. Все остается как было.

-  Если при экспорте статьи, есть фрагменты, которые мы не умеем экспортировать (`функциональные блоки`, `формулы`, `OpenAPI`, `Ссылка См.`, `группы картинок`), то выдается окно предупреждения:

   -  *Заголовок*: (!) Неподдерживаемые элементы

   -  *Текст*: Экспорт в DOCX не поддерживает следующие специальные элементы Gramax:

      -  Формула

      -  Описание OpenAPI

      -  Функциональный блок

      -  Группа картинок

      Файл сохранится без них.

   -  *Кнопки*:

      -  `Продолжить` -- экспортируется файл без неподдерживаемых элементов.

![](./docx-style-27.png "Пример неподдерживаемых элементов в статье")

-  Весь документ имеет дефолтные поля (отступы от края страницы)

-  Внешний вид элементов соответствует указанным ниже

### Внешний вид элементов

#### Простые элементы

{% table %}

---

*  {% colwidth=[366] isHeader=true %}

   Вид в приложении

*  {% colwidth=[365] isHeader=true %}

   Вид в word

---

*  {% colwidth=[366] %}

   ![](./docx-style-32.png "Заголовки")

*  {% colwidth=[365] %}

   ![](./docx-style.png)

---

*  {% colwidth=[366] %}

   ![](./docx-style-51.png "Жирный, курсивный ссылка")

*  {% colwidth=[365] %}

   ![](./docx-style-6.png)

---

*  {% colwidth=[366] %}

   ![](./docx-style-7.png "Блок кода и строка кода")

*  {% colwidth=[365] %}

   ![](./docx-style-8.png)

---

*  {% colwidth=[366] %}

   ![](./docx-style-28.png "Таблица")

*  {% colwidth=[365] %}

   ![](./docx-style-9.png)

---

*  {% colwidth=[366] %}

   ![](./docx-style-33.png "Списки")

*  {% colwidth=[365] %}

   ![](./docx-style-12.png "Тут проблема: не экспортируется список с одним элементом")

---

*  {% colwidth=[366] %}

   ![](./docx-style-14.png "Параграф")

*  {% colwidth=[365] %}

   ![](./docx-style-15.png)

---

*  {% colwidth=[366] %}

   ![](./docx-style-40.png "Горизонтальная линия")

*  {% colwidth=[365] %}

   ![](./docx-style-41.png)

{% /table %}

#### Блочные элементы, диаграммы и картинки

{% table %}

---

*  {% colwidth=[366] isHeader=true %}

   ![](./docx-style-13.png "Все заметки")

*  {% colwidth=[365] isHeader=true %}

   ![](./docx-style-34.png "Сделаны на основе таблиц")

---

*  {% colwidth=[366] %}

   ![](./docx-style-26.png "Цитаты")

*  {% colwidth=[365] %}

   ![](./docx-style-56.png "Сделаны на основе таблиц")

---

*  {% colwidth=[366] %}

   ![](./docx-style-10.png "Блоки скрытого текста")

*  {% colwidth=[365] %}

   ![](./docx-style-2.png "Сделаны на основе таблиц")

---

*  {% colwidth=[366] %}

   ![](./docx-style-44.png "Вкладки")

*  {% colwidth=[365] %}

   ![](./docx-style-45.png "Сделаны на основе таблиц")

---

*  {% colwidth=[366] %}

   ![](./docx-style-4.png "diagrams.net")

*  {% colwidth=[365] %}

   ![](./docx-style-5.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-11.png "mermaid")

*  {% colwidth=[365] %}

   ![](./docx-style-29.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-30.png "plantUML")

*  {% colwidth=[365] %}

   ![](./docx-style-35.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-42.png "ER-диаграмма")

*  {% colwidth=[365] %}

   ![](./docx-style-43.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-47.png "TS-диаграммы")

*  {% colwidth=[365] %}

   ![](./docx-style-48.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-36.png "Картинка")

*  {% colwidth=[365] %}

   ![](./docx-style-37.png "Картинка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-31.png "Если \"не удалось отобразить диаграмму\"")

*  {% colwidth=[365] %}

   ![](./docx-style-57.png "Будет экспортироваться Danger Заметка")

---

*  {% colwidth=[366] %}

   ![](./docx-style-58.png "У draw.io \"не удалось отобразить диаграмму\" выглядит так")

*  {% colwidth=[365] %}

   ![](./docx-style-62.png "Но мы все равно экспортируем это так")

---

*  {% colwidth=[366] %}

   ![](./docx-style-59.png "При неудачной загрузке картинки")

*  {% colwidth=[365] %}

   ![](./docx-style-60.png)

{% /table %}

#### Элементы, создаваемые только через Markdown

{% table %}

---

*  {% colwidth=[365] %}

   ![](./docx-style_4.png "БД-таблица")

*  {% colwidth=[365] %}

   ![](./docx-style_5.png)

   ![](./docx-style_6.png "Это экспортируется, хотя в редакторе ее не видно")

---

*  {% colwidth=[365] %}

   ![](./docx-style_11.png "Термин")

*  {% colwidth=[365] %}

   ![](./docx-style_12.png)

---

*  {% colwidth=[365] %}

   ![](./docx-style_13.png)

*  {% colwidth=[365] %}

   ![](./docx-style-3.png)

---

*  {% colwidth=[365] %}

   ![](./docx-style-49.png "Иконки")

*  {% colwidth=[365] %}

   ![](./docx-style-55.png)

---

*  {% colwidth=[365] %}

   ![](./docx-style_15.png "kbd")

*  {% colwidth=[365] %}

   ![](./docx-style_16.png "почти не видно, но он обрамляется светлой линией")

---

*  {% colwidth=[365] %}

   ![](./docx-style_17.png "color")

*  {% colwidth=[365] %}

   ![](./docx-style_18.png)

---

*  {% colwidth=[365] %}

   ![](./docx-style-39.png "alfa beta issue module")

*  {% colwidth=[365] %}

   ![](./docx-style-46.png)

---

*  {% colwidth=[365] %}

   ![](./docx-style_21.png)

*  {% colwidth=[365] %}

   ![](./docx-style_22.png)

{% /table %}

#### Экспортируются с ограничениями:

{% table %}

---

*  {% isHeader=true %}

   ![](./docx-style-16.png "Видео")

*  {% isHeader=true %}

   ![](./docx-style-17.png)

---

*  ![](./docx-style-18.png "Видео с подписью")

*  ![](./docx-style-19.png)

---

*  ![](./docx-style-20.png "Сниппет")

*  ![](./docx-style-21.png)

   ***Сниппеты*** -- экспортируются как

   **обычный текст**. Не баг, а фича: чтобы

   сниппеты индексировались,

   нужно обновлять страницу.

---

*  ![](./docx-style-24.png "Блочные элементы в списке")

*  ![](./docx-style-25.png)

---

*  ![](./docx-style-22.png "Содержимое статей")

*  ![](./docx-style-23.png "Как обычный текст")

---

*  ![](./docx-style-50.png)

*  ![](./docx-style-52.png)

---

*  ![](./docx-style-54.png "Переменные")

*  ![](./docx-style-53.png "Как обычный текст")

{% /table %}

## Технические детали

-  Создается xml аналогично этой документации: <https://docx.js.org/#/usage/styling-with-xml>. Это позволит отображать их в `галерее стилей`

-  Там будут храниться все шрифты и отступы и стили таблиц

-  Если надо поменять или добавить стили:

   1. Экспортируем файл в DOCX

   2. Делаем стили, изменяем стили так, как нужно

   3. дальше всё по инструкции: <https://docx.js.org/#/usage/styling-with-xml>