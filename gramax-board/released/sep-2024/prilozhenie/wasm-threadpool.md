---
order: 10.5
title: "@PS @PS [done] Пул потоков для исполнения функций WASM"
---

WASM выполняется в отдельном воркере. Он поддерживает многопоток, но тем не менее наш код выполняется в основном потоке и поэтому функции, которые долго выполняются, либо функции, которые выполняются очень часто, могут блокировать этот поток и приложение “тупит“.

Особенно это заметно на главной странице при фетче и подсчёте количества изменённых файлов.

Нужно прикрутить многопоточность.

## Критерии

1. Функции WASM не блокируют выполнение других его функций, поскольку WASM-модуль умеет использовать потоки для распараллеливания задач

   1. Основной поток занимается распределением задач по другим потокам и возвращением результата выполнения в JS

## Результат

От `cmd`\+`R` до загрузки каталога `gramax-board`

{% table %}

---

*  {% isHeader=true %}

   

*  {% isHeader=true %}

   Было ([app.gram.ax](http://app.gram.ax))

*  {% isHeader=true %}

   Стало ([dev.gram.ax](http://dev.gram.ax))

*  {% colwidth=[92] isHeader=true %}

   %

---

*  Загрузка главной страницы **с** фетчем каталогов

*  28s ([vid](./app.fetch.mp4))

*  9\.5s ([vid](./dev.fetch.mp4))

*  {% colwidth=[92] %}

   **\-66%**

---

*  Загрузка главной страницы **без** фетча каталогов

*  12s ([vid](./app.mp4))

*  6s ([vid](./dev.mp4))

*  {% colwidth=[92] %}

   **\-50%**

{% /table %}
