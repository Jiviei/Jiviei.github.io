---
order: 3
title: Мастер-класс3
---

Всем привет! Меня зовут Катя, я продакт Gramax. Сегодня на мастер-классе мы вместе с вами развернем собственный портал документации. Без технических знаний, разработчиков и девопсов.

Как вы могли прочитать в аннотации, нам потребуется:

1. Ноутбук.

2. Профиль на гитлаб или гитхаб. Если нет -- можете прямо сейчас зарегистрировать.

3. Собственный сервер или аккаунт в любом облаке. Если такого нет -- не спешите, прямо во время мастер-класса создадим аккаунты в яндекс клауде (это не реклама, просто у них есть грант за регистрацию).

Давайте примерно посчитаемся, кто будет делать практику, а кто будет просто смотреть. Поднимите руки, кто готов делать практику?

## Что за Gramax

В первую очередь я хочу рассказать вам про Gramax. Gramax -- это опенсурсное приложение для тех, кто хочет быстро и легко редактировать документацию с подходом Docs as Code. Никаких локальных серверов, настройки окружения и сложных инженерных практик. С минимальными знаниями можно развернуть свой полноценный сайт для читателей, а редактировать в простом и понятном приложении.

На словах может не очень понятно, будет легче разобраться в процессе.

Все готовы?

Давайте сразу откроем статью с материалами, чтобы каждый раз не сканировать коды или не набирать ссылки.

## Шаг 1. Создаем каталог

В первую очередь нам нужно создать каталог с документацией.

1. Открываем браузерную версию Gramax -- ссылка на нее находится в статье в блоке “Шаг 1”.

2. Создаем каталог. Кликаем “Создать новый”.

3. Добавляем тестовые статьи. Штучки 2-3.

4. Оформляем статьи. Красивыми делать их не будем, просто потыкаем разные кнопочки в панели. Например:

   1. Добавим диаграмму.

   2. Описание OpenAPI.

   3. Заметку.

   4. Список.

   5. Картинку.

5. Задаем URL статей.

6. Настраиваем каталог. В правой панели кликаем “Настроить” и заполняем данные. Они отобразятся на главной странице.

Думаю, для начала этого достаточно. Давайте опубликуем этот каталог.

## Шаг 2. Подключение хранилища и публикация каталога

Чтобы Gramax понял, куда опубликовать каталог, нужно подключить хранилище.

1. Кликаем облачко в панели состояния репозитория.

2. Добавить новое хранилище, выбираем гитлаб или гитхаб.

3. В случае с гитхабом -- переходим в интерфейс гитхаба. В гитлабе -- создаем access token. Кто входит через гитлаб, нужна помощь с созданием токена?

4. Добавили хранилище, теперь в него можно опубликовать каталог -- выбираем аккаунт и кликаем “Выбрать”. В этот момент в хранилище создается репозиторий с нашими файлами.

Смотрим строку состояния репозитория -- тут появилась ветка и кнопка синхронизации. Значит репозиторий создан и связь установлена.

## Шаг 3. Создание аккаунта в облаке

Каталог создан и загружен в хранилище. Самое время опубликовать его для читателей.

Давайте сначала разберемся, кто где его будет разворачивать.

-  Поднимите руки, кто хочет развернуть на своем сервере?

-  Поднимите руки, кто хочет развернуть не в яндекс клауде?

-  Поднимите руки, кто вместе с нами сейчас будет разворачивать в яндекс клауде?

## Шаг 4. Создание ВМ

1. Откройте <https://cloud.yandex.ru/ru/> и войдите в свой аккаунт.

2. Перейдите в консоль и добавьте платежный аккаунт. Да, там придется указать карточку и номер телефона, но позже эти данные можно удалить.

   После регистрации будет начислен грант 4000р -- его будем использовать для разворачивания.

3. Нажмите “Создать ресурс” и выберите “Виртуальная машина”.

4. Укажите имя машины -- например, Gramaxtest.

5. Перейдите на вкладку “container solution” и кликните “Настроить”.

6. Чтобы вручную не задавать настройки, перейдите на вкладку “Docker compose”.

7. Перейдите по ссылке [gram.ax/docker-compose.ya-cloud.yaml](http://gram.ax/docker-compose.ya-cloud.yaml) из 7 пункта инструкции и скопируйте текст файла. Вставьте его в поле “Docker compose”. В нем можно опционально заменить некоторые параметры:

   1. Номер порта. Если у вас локально что-то развернуто на порте 80:80 - замените его. Например, на порт 81:80.

   2. Логин и пароль администратора. Администратор добавляет и обновляет новые каталоги на портале. Чтобы в админку никто не смог забраться без вашего ведома, замените данные. Сегодня, думаю, можно оставить стандартные.

8. Нажмите “Применить”.

## Шаг 5. Настройка безопасного подключения

Теперь нужно подключиться к виртуальной машине. Для этого используется SSH-ключ.

1. Откройте консоль и введите команду -- она создаст уникальный ключ. Команду можно скопировать в инструкции, если она открыта.

   ```
   ssh-keygen -t ed25519 -f ~/.ssh/yandex_cloud_gramax
   ```

2. Нажмите 2 раза энтер.

3. Скопируйте SSH-ключ. Для этого используйте команду:

   1. На мак:

      ```
      cat ~/.ssh/yandex_cloud_gramax.pub | pbcopy
      ```

   2. На вин:

      ```
      cat ~/.ssh/yandex_cloud_gramax.pub | clip
      ```

4. Откройте ВМ в облаке и вставьте ключ в поле. Также задайте логин администратора -- например, testgramax.

5. Нажмите “Создать ВМ”.

## Шаг 6. Загрузка каталогов на портал

Теперь нам нужно открыть портал, который мы только что создали. Он доступен по адресу:

```
http://{ip адрес}:{порт}/
```

-  ip-адрес -- открываем список виртуальных машин в облаке и копируем “Публичный iPv4”.

-  порт -- указывали в докер-компоузе. По-умолчанию 80:80, но если вы его поменяли -- укажите свой.

1. Переходим по ссылке.

2. Открываем админку. Для этого добавляем в путь /admin.

3. Вводим логин и пароль. Если вы их не меняли в докер-компоузе, это будет admin/password.

4. Нажимаем “Загрузить существующий” и подключаем хранилище, как в приложении.

5. Выбираем каталог, который опубликовали.

6. А вот и он. Можно выйти из админки и полюбоваться результатом!

## 