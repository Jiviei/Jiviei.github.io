---
order: 4.9
title: Роли и разграничение доступов
---

## Старт сервера и Владелец воркспейса

Т.к. пока у нас воркспейс равен организации, то и Владелец воркспейса равен Владельцу организации. Позже сможем добавить уровень выше и дополнительную роль Владелец организации.

-  [comment:KwFoI]Получил и установил дистрибутив GES[/comment], для входа просит указать лицензионный ключ.

-  При вводе лицензионного ключа я автоматически становлюсь Владельцем воркспейса. И автоматически списывается первая лицензия с лицензионного ключа.

-  Подключаю Git-хранилище.

-  [comment:1JsRq]Объявляю группы пользователей в воркспейсе и кто в них входит: группы пользователей и пользователи из AD[/comment]. Группа GES и o2m c перечислением групп и пользователей из AD.

   -  У групп есть GUID, чтобы их можно было переимено вывать без проблем.

   -  [comment:5bG1b]Если группу удалили, то, в идеале, удалить её из настроек всех каталогов воркспейса.[/comment]

-  Назначаю Владельцев воркспейса. В разрезе каталогов Назначаю Владельцев, Редакторов и  Читателей. В идеале, иметь возможность смотреть и назначать каталоги в разрезе пользователей, как это сделано в YouTrack.

   -  Когда назначаю Владельца воркспейса или Владельца каталога, то он сразу становится Редактором. Смысл в том, чтобы расходовалась лицезия.

   -  Каждый Редактор расходует лицензию GES.

   -  Если пользователь был деактивирован в AD, то он пропадает из настроек и не расходует лицензию.

-  Могу просмотреть сколько лицензий осталось на лицензионном ключе и дату окончания действия ключа. Для безлимитных ключей вижу знак бесконечности.

Все настройки делаю на форме редактирования воркспейса. В идеале хранить настройки в Git-репозитории, т.к., например, в Ютреке часто сталкиваемся с ситуацией, когда кто-то поменял настройки пользователей и никто не знает кто это сделал и в каком объёме. Иногда нужно просто откатить сделанные ошибочные настройки или дать кому-то на ревью.

## Создание каталога редактором

-  Создаю новый каталог. Автоматически становлюсь Владельцем каталога.

-  При публикации выбираю в какое Git-хранилище публикую. Если в воркспейсе только одно Git-хранилише, то этот шаг пропускается.

-  Назначаю кому доступен этот каталог: Владельцы каталога, Редакторы и Читатели. Если у человека есть доступ к каталогу, то этот каталог автоматически подгружается ему в приложение.

   -  Если такой группы не существует (удалили или добавили в Markdown), то в настройках каталога вижу ошибку, но она не блокирует публикацию.

   -  Если пользователь был деактивирован в AD, то он пропадает из настроек и не расходует лицензию.

Все настройки реализуются в настройках каталога. Наверное, лучше хранить настройки доступов отдельно от контента настраиваемого репозитория, чтобы не видеть коммиты, которые не относятся к контенту.

## Настройка докпортала

Т.к. под это нет UI и непонятно когда будет, то описано не от первого лица.

1. Если доступы не указаны, то каталог доступен всем без аутентификации, если добавлен на докпортал.

2. Докпортал может быть развёрнут с необходимостью авторизации:

   1. Режим включает SSO на докпортале и показывает контент пользователям с учётом их доступов.

   2. Если докпортал запущен без включенного режима, то все каталоги доступны всем без аутентификации.

3. Пользователь с ролью Владелец каталога может настроить доступы на докпортале и другие настройки. Можем добавить под это отдельную роль *Администратор докпортала*, но пока нет UI под это, то как-будто нет необходимости.

## Матрица доступов

{% table %}

---

*  {% colwidth=[343] %}

   Доступы (пермишены) / Роли

*  {% colwidth=[193] %}

   Владелец воркспейса **(workspaceOwner)**

*  {% colwidth=[190] %}

   Владелец каталога 

   **(catalogOwner)**

*  {% colwidth=[155] %}

   Редактор **(editor)**

*  {% colwidth=[158] %}

   [comment:LsNTn]Рецензент[/comment] 

   **(reviewer)**

*  {% colwidth=[132] %}

   Читатель

   **(reader)**

---

*  {% colwidth=[343] %}

   **ConfigureWorkspace**

   -  Изменение настроек воркспейса 

   -  Изменение групп в воркспейсе 

   -  Управление составом каталога

   -  Изменение git-хранилищ воркспейса

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \-

*  {% colwidth=[155] %}

   \-

*  {% colwidth=[158] %}

   \-

*  {% colwidth=[132] %}

   \-

---

*  {% colwidth=[343] %}

   **ReadWorkspace**

   -  Чтение групп в воркспейсе  

   -  Чтение git-хранилищ воркспейса

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \+

*  {% colwidth=[155] %}

   \+

*  {% colwidth=[158] %}

   \-

*  {% colwidth=[132] %}

   \-

---

*  {% colwidth=[343] %}

   **ConfigureCatalog**

   -  [comment:6UvAw]Изменение свойств каталога[/comment]

   -  Изменение ветки и синхронизация в докпортале

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \+

*  {% colwidth=[155] %}

   \-

*  {% colwidth=[158] %}

   \-

*  {% colwidth=[132] %}

   \-

---

*  {% colwidth=[343] %}

   **EditCatalog**

   -  Создание каталога 

   -  Управление ветками

   -  Есть кнопка *Редактировать в грамакс* в докпортале

   -  Изменение ветки и синхронизация в приложении

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \+

*  {% colwidth=[155] %}

   \+

*  {% colwidth=[158] %}

   \-

*  {% colwidth=[132] %}

   \-

---

*  {% colwidth=[343] %}

   **EditCatalogСontent**

   -  [comment:eXxoB]Изменение содержимого каталога[/comment]

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \+

*  {% colwidth=[155] %}

   \+

*  {% colwidth=[158] %}

   \+

*  {% colwidth=[132] %}

   \-

---

*  {% colwidth=[343] %}

   **ReadCatalogСontent**

   -  Чтение содержимого каталога

*  {% colwidth=[193] %}

   \+

*  {% colwidth=[190] %}

   \+

*  {% colwidth=[155] %}

   \+

*  {% colwidth=[158] %}

   \+

*  {% colwidth=[132] %}

   \+

{% /table %}

Основной прицнип разделения доступов -- всё, что не разрешено – запрещено. Т.к. в базе знаний может быть чувствительная информация и лучше при необходимости открывать доступ, чем наоборот.


