---
order: 1
title: "@DK [done] Сниппеты"
---

Сниппеты -- специальные контролы для повторного использования текста в различных статьях, упрощающие управление контентом и обеспечивающие консистентность информации.

### Сценарий

-  Пользователь открывает текст статьи и выбирает опцию *Сниппет* в тулбаре. Отображается выпадающий список доступных сниппетов и кнопка создания сниппета.

-  Пользователь кликает по сниппету из списка, который он хочет вставить, дропдаун закрывается и сниппет вставляется в позицию курсора.

-  Сниппет ведет себя как ридонли-фрагмент. Пользователь кликает по нему дважды, открывается модальное окно где он может отредактировать сниппет.

### Требования

-  **Тулбар вставки сниппета**. В тулбаре есть кнопка  [icon:tarp] *Cниппет*. При нажатии на нее вверх открывается поисковая строка и выше нее выпадающий список сниппетов:

   -  Если нет ни одного: будет только кнопка *\+ Добавить новый сниппет*

   -  При клике на элемент в текущую позицию курсора вставляется сниппет.

   -  При наведении на элемент отображается карандашик, при нажатии на которую открывается окно редактирования сниппета.

   -  Кнопка *\+ Создать сниппет*: отделена от списка разделителем. При нажатии открывается окно создания сниппета.

-  **Окно редактирования сниппета**. Выглядит как обычное модальное окно.

   -  Заголовок: *Редактирование сниппета* / *Создание сниппета* -- в зависимости от того создаем или редактируем.

   -  Поля. Отображаются сверху название поля, [снизу]() контрол:

      -  *Название* -- Обязательное. Задает отображаемое в дропдауне имя. Отображается в верхнем ряду наполовину ширину.

      -  *id* -- Задает имя файла. Действуют те же правила для формирования имени, что и на статью, т.е. с транслитерацией названия и дальше не меняется. При редактировании сниппета поле ридонли. Расположено в верхнем ряду на остальную половину ширины, справа от названия. Расположено в правой половине от названия.

      -  *Содержимое --* Редактор с ограниченным форматированием, аналогичный комментариям.

      -  Посмотреть использования

         -  Если нигде не используется “Сниппет нигде не используется“

         -  Снизу поля “сожержимое“ {Блок просмотра использований}

   -  Кнопки: стандартные *Сохранить* и *Отменить*. А еще:

      -  *Удалить* (можно сделать позже после демо). Доступна только при редактировании сниппета. При нажатии проверяется, используется ли сниппет где-нибудь, если да, то выдается сообщение со стилем `ворнинг`:

         -  Заголовок: *Удаление используемого сниппета*

         -  Сообщение: *Вы собираетесь удалить сниппет, который в настоящее время используется в одной или более статьях:*

            {Блок просмотра использований}

            *После удаления сниппета, в статьях, где он использовался, возникнут ошибки вместо отображения удаленного сниппета.*

            *Вы уверены, что хотите продолжить?*

            -  При нажатии на ссылку *просмотреть использования* открывается выпадающий список со ссылками на статьи, в которых используется этот сниппет.

         -  Кнопка *Удалить сниппет*.

-  **Блок просмотра использований**

   -  

-  **Просмотр сниппета в статье**. Содержимое сниппета отображается в режиме чтения как картинка блочным элементом. В фокусе выделяется стандартной синей рамочкой. (радиус 4xp)

   -  Специального тулбара не имеет.

   -  При двойном клике открывается модальное окно редактирования сниппета.

   -  Можно удалить из статьи стандартно. Например, нажатием backspace и delete.

### Под капотом

-  Сниппеты хранятся в директории `.snippets`, расположенной в корневой директории (рядом с `.doc-root.yaml`).

-  Каждый сниппет выглядит как отдельная статья, в т.ч. заголовок хранится во frontmattier.

-  В markdown сниппета выглядит как: `[snippet:{код сниппета}]`

-  Изображения, вставленные в сниппеты, хранятся рядом с файлом сниппета.

-  Сниппеты могут содержать ссылки на другие статьи или ресурсы, ссылки формируются от корневой директории (можно сделать вторым этапом)

### Дальнейшие шаги

-  **Ошибки рендеринга**. Завел отдельную US

-  **Битые ссылки на** **сниппеты**.

   -  В интерфейсе *Проверки на ошибки* битые ссылки на сниппеты отображаются в отдельной секции и логика полностью повторяет логику битых ссылок на статьи.

   -  При отображении статьи если сниппет не найден выдается стандартная ошибка рендеринга (потом ее задизайним, пока она красный note).

-  **Расширенное форматирование в содержимом**. Сейчас пока обрезок. Надо добавить возможность вставить картинки и другие элементы.